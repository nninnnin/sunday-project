<!DOCTYPE html>
<html lang="en">
<head>
    <%- include ('partials/head') %>
    <link rel="stylesheet" href="css/index.css">
</head>
<body class="fade-in">
    <!-- header -->
    <header>
        <%- include ('partials/header') %>
    </header>

    <main>
        <!-- main section -->
        <section>
            <!-- articles -->
            <div class="article">
                <% for (post of posts){ %> 
                    <a href="/diary/<%= post._id %>">
                        <div class="post">
                            <h1>
                                <%= post.title %>
                            </h1>
                            <% const time = post._id.getTimestamp() %>
                            <br>
                        </div>
                    </a>
                <% } %> 
            </div>
            
            <!-- drawings -->
            <!-- <div class="drawing">
                <% imgs.forEach(img => { %>
                    <div>
                        <img src="imgs/music/<%= img.id %>.jpg" alt="<%= img.id %> ">
                    </div>
                <% }) %>
            </div> -->

            <!-- newest visitors (최신 방명록) -->
            <div class="visitors">
                <% for ([index,visitor] of visitors.entries()) { %> 
                <a href="/visitor#<%= index %>"><!-- 추후 해시 이용해서 해당 글 위치로 스크롤까지 -->
                    <div class="visitor">
                        <span id="name">NEW!</span> : <%= visitor.content %> 
                    </div>
                </a>
                <% } %> 
            </div>

        </section>

        <!-- side section -->
        <aside>
            <div class="contact-info">
                <b>CONTACT</b>
                <br>
                nninnnin7@gmail.com
            </div>

            <div class="insta-photo">
                <b>INSTAGRAM</b>
                
                
                <div id="instagram-embed">
                <img alt="instagram-image" id="img1">
                </div>
            </div>
        </aside>
    </main>

        <!-- footer -->
        <footer>
            <%- include ('partials/footer')  %>
        </footer>
        <i class="fas fa-chevron-circle-up fa-2x" id="home"></i>
    </div>

    <!-- common.js -->
    <script src="../libs/common.js"></script>

    <script>
        console.log('index')
        const xhr = new XMLHttpRequest();
        xhr.onreadystatechange = (e)=>{
        // readyState 가 4단계로서 통신이 완료된 단계이며
            if(xhr.readyState !== XMLHttpRequest.DONE){
                return
            }   
        // status가 200으로 통신이 성공적으로 이루어졌을 때
            if(xhr.status === 200){
                console.log(xhr);
            } else{
                console.log(`통신이 성공적으로 이루어지지 못했네요 status code = ${xhr.status} : ${xhr.statusText}`)
            }
        }
        xhr.open('GET','/diary');
        xhr.send();
    </script>

</body>
</html>
